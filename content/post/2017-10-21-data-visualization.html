---
title: 3 Data Visualization - R for Data Science
author: Patrick O'Malley
date: '2017-10-21'
categories:
  - R for Data Science
tags:
  - R
  - Visualization
  - ggplot2
output:
  blogdown::html_page:
    toc: true
slug: data-visualization
autoThumbnailImage: no
thumbnailImage: /images/mpg.png
thumbnailImagePosition: left
description: 'This post covers the content and exercises for Ch 3: Data Visualization
  in **R for Data Science**'
---


<div id="TOC">
<ul>
<li><a href="#first-steps">3.2 First Steps</a><ul>
<li><a href="#exercises">3.2.4 Exercises</a></li>
</ul></li>
<li><a href="#aesthetic-mappings">3.3 Aesthetic Mappings</a><ul>
<li><a href="#exercises-1">3.3.1 Exercises</a></li>
</ul></li>
<li><a href="#facets">3.5 Facets</a><ul>
<li><a href="#exercises-2">3.5.1 Exercises</a></li>
</ul></li>
<li><a href="#geometric-objects">3.6 Geometric Objects</a><ul>
<li><a href="#exercises-3">3.6.1 Exercises</a></li>
</ul></li>
<li><a href="#statistical-transformations">3.7 Statistical Transformations</a><ul>
<li><a href="#exercises-4">3.7.1 Exercises</a></li>
</ul></li>
<li><a href="#position-adjustments">3.8 Position Adjustments</a><ul>
<li><a href="#exercises-5">3.8.1 Exercises</a></li>
</ul></li>
<li><a href="#coordinate-systems">3.9 Coordinate Systems</a><ul>
<li><a href="#exercises-6">3.9.1 Exercises</a></li>
</ul></li>
<li><a href="#the-layered-grammar-of-graphics">3.10 The Layered Grammar of Graphics</a></li>
</ul>
</div>

<p>This post covers the content and exercises for Ch 3: Data Visualization from <a href="http://r4ds.had.co.nz/"><strong>R for Data Science</strong></a>. The chapter teaches the use of the grammar of graphics with ggplot2.</p>
<div id="first-steps" class="section level1">
<h1>3.2 First Steps</h1>
<p>We begin by loading the tidyverse which contains ggplot2 and numerous other useful libraries.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<p>The first plot addresses the question: Do cars with big engines use more fuel than cars with small engines?</p>
<pre class="r"><code>head(mpg)</code></pre>
<pre><code>## # A tibble: 6 x 11
##   manufacturer model displ  year   cyl      trans   drv   cty   hwy    fl
##          &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;      &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;
## 1         audi    a4   1.8  1999     4   auto(l5)     f    18    29     p
## 2         audi    a4   1.8  1999     4 manual(m5)     f    21    29     p
## 3         audi    a4   2.0  2008     4 manual(m6)     f    20    31     p
## 4         audi    a4   2.0  2008     4   auto(av)     f    21    30     p
## 5         audi    a4   2.8  1999     6   auto(l5)     f    16    26     p
## 6         audi    a4   2.8  1999     6 manual(m5)     f    18    26     p
## # ... with 1 more variables: class &lt;chr&gt;</code></pre>
<pre class="r"><code>ggplot(data = mpg) +
        geom_point(mapping = aes(x = displ, y = hwy))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/mpg-1.png" width="672" /></p>
<div id="exercises" class="section level2">
<h2>3.2.4 Exercises</h2>
<ol style="list-style-type: decimal">
<li>Run ggplot(data = mpg). What do you see?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/empty-plot-1.png" width="672" /></p>
<p>It’s an empty plot</p>
<ol start="2" style="list-style-type: decimal">
<li>How many rows are in mpg? How many columns?</li>
</ol>
<pre class="r"><code>dim(mpg)</code></pre>
<pre><code>## [1] 234  11</code></pre>
<p>234 rows and 11 columns</p>
<ol start="3" style="list-style-type: decimal">
<li>What does the drv variable describe? Read the help for ?mpg to find out.</li>
</ol>
<p>drv indicates whether its front / rear / 4 wheel drive</p>
<ol start="4" style="list-style-type: decimal">
<li>Make a scatterplot of hwy vs cyl.</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) +
        geom_point(aes(x = cyl, y = hwy))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/plot-hwy-cyl-1.png" width="672" /></p>
<ol start="5" style="list-style-type: decimal">
<li>What happens if you make a scatterplot of class vs drv? Why is the plot not useful?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) + 
        geom_point(mapping = aes(x = drv, y = class))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/class-vs-drv-1.png" width="672" /></p>
<p>Scatterplots are not useful when looking at two categorical variables</p>
</div>
</div>
<div id="aesthetic-mappings" class="section level1">
<h1>3.3 Aesthetic Mappings</h1>
<p>They are used to set things like color and shapes based on a variable value</p>
<pre class="r"><code>ggplot(data = mpg) +
        geom_point(aes(x = displ, y = hwy, color = class))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/mpg-outliers-1.png" width="672" /></p>
<p>The outliers with high displacements and high mileage are 2 seaters. Since sports cars are lighter than the trucks and suvs in this displacement range it makes sense that they have higher mpg</p>
<div id="exercises-1" class="section level2">
<h2>3.3.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li>What’s gone wrong with this code? Why are the points not blue?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = &quot;blue&quot;))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/wrong-color-1.png" width="672" /></p>
<p>The color should have been set outside of the aes</p>
<ol start="2" style="list-style-type: decimal">
<li>Which variables in mpg are categorical? Which variables are continuous? (Hint: type ?mpg to read the documentation for the dataset). How can you see this information when you run mpg?</li>
</ol>
<pre class="r"><code>summary(mpg)</code></pre>
<pre><code>##  manufacturer          model               displ            year     
##  Length:234         Length:234         Min.   :1.600   Min.   :1999  
##  Class :character   Class :character   1st Qu.:2.400   1st Qu.:1999  
##  Mode  :character   Mode  :character   Median :3.300   Median :2004  
##                                        Mean   :3.472   Mean   :2004  
##                                        3rd Qu.:4.600   3rd Qu.:2008  
##                                        Max.   :7.000   Max.   :2008  
##       cyl           trans               drv                 cty       
##  Min.   :4.000   Length:234         Length:234         Min.   : 9.00  
##  1st Qu.:4.000   Class :character   Class :character   1st Qu.:14.00  
##  Median :6.000   Mode  :character   Mode  :character   Median :17.00  
##  Mean   :5.889                                         Mean   :16.86  
##  3rd Qu.:8.000                                         3rd Qu.:19.00  
##  Max.   :8.000                                         Max.   :35.00  
##       hwy             fl               class          
##  Min.   :12.00   Length:234         Length:234        
##  1st Qu.:18.00   Class :character   Class :character  
##  Median :24.00   Mode  :character   Mode  :character  
##  Mean   :23.44                                        
##  3rd Qu.:27.00                                        
##  Max.   :44.00</code></pre>
<p>cyt and hwy are the only continuous variables</p>
<ol start="3" style="list-style-type: decimal">
<li>Map a continuous variable to color, size, and shape. How do these aesthetics behave differently for categorical vs. continuous variables?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) + 
        geom_point(mapping = aes(x = displ, y = hwy, color = cty))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/map-cont-var-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) + 
        geom_point(mapping = aes(x = displ, y = hwy, size = cty))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/map-cont-var-2.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) + 
        geom_point(mapping = aes(x = displ, y = hwy, shape = cty))</code></pre>
<pre><code>## Error: A continuous variable can not be mapped to shape</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/map-cont-var-3.png" width="672" /></p>
<p>Size and color work with continuous variables, they just display a gradient. Shape does not work with continuous variables however.</p>
<ol start="4" style="list-style-type: decimal">
<li>What happens if you map the same variable to multiple aesthetics?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) + 
        geom_point(mapping = aes(x = displ, y = hwy, size = cty, color = cty, alpha = cty))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/mult-aes-1.png" width="672" /></p>
<p>It’s not very helpful to use multiple aes on a single variable</p>
<ol start="5" style="list-style-type: decimal">
<li>What does the stroke aesthetic do? What shapes does it work with? (Hint: use ?geom_point)</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) + 
        geom_point(mapping = aes(x = displ, y = hwy), shape = 21, stroke = 4)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/stroke-aes-1.png" width="672" /></p>
<p>stroke modifies the width of the shape border</p>
<ol start="6" style="list-style-type: decimal">
<li>What happens if you map an aesthetic to something other than a variable name, like aes(colour = displ &lt; 5)?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) + 
        geom_point(mapping = aes(x = displ, y = hwy, color = displ &lt; 5))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/non-var-aes-1.png" width="672" /></p>
<p>It segments the aes based on the criteria specified</p>
</div>
</div>
<div id="facets" class="section level1">
<h1>3.5 Facets</h1>
<p>Facets can be used to split plots on categorical variable levels</p>
<p><code>facet_wrap()</code> is used for splitting on a single variable</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ class, nrow = 2)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/facet-wrap-1.png" width="672" /></p>
<p><code>facet_grid()</code> is used for splitting on two variables</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_grid(drv ~ cyl)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/facet-grid-1.png" width="672" /></p>
<p><code>facet_grid(.~cyl)</code> can be used to only facet by 1 variable</p>
<div id="exercises-2" class="section level2">
<h2>3.5.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li>What happens if you facet on a continuous variable?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ cty, nrow = 3)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/facet-cont-var-1.png" width="672" /></p>
<p>A facet is created for each value</p>
<ol start="2" style="list-style-type: decimal">
<li>What do the empty cells in plot with facet_grid(drv ~ cyl) mean? How do they relate to this plot?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = drv, y = cyl))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/empty-cells-1.png" width="672" /></p>
<p>The empty cells indicate there are no data for that combination of variables</p>
<ol start="3" style="list-style-type: decimal">
<li>What plots does the following code make? What does . do?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(drv ~ .)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/using-period-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(. ~ cyl)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/using-period-2.png" width="672" /></p>
<p>drv is displayed in a single column and cyl is displayed in a single row</p>
<ol start="4" style="list-style-type: decimal">
<li>Take the first faceted plot in this section: What are the advantages to using faceting instead of the colour aesthetic? What are the disadvantages? How might the balance change if you had a larger dataset?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ class, nrow = 2)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/facet-vs-color-1.png" width="672" /></p>
<p>Faceting allows you to quickly distinguish the pattern for each level, however using color allows easier comparison between the levels. When working with larger data it may become difficult to clearly distinguish points based on color.</p>
<ol start="5" style="list-style-type: decimal">
<li>Read ?facet_wrap. What does nrow do? What does ncol do? What other options control the layout of the individual panels? Why doesn’t facet_grid() have nrow and ncol argument?</li>
</ol>
<p>nrow and ncol specify the number of rows and columns for the facets to occupy respectively. Other options include:<br />
* switch - change location of labels * drop - removes unused factor levels * dir - direction * strip.position - change location of labels <code>facet_grid()</code> doesn’t use nrow and ncol since they are determined by the number of levels of the variables</p>
<ol start="6" style="list-style-type: decimal">
<li>When using <code>facet_grid()</code> you should usually put the variable with more unique levels in the columns. Why?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_grid(drv ~ class)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/grid-multi-cols-1.png" width="672" /></p>
<p>Plots are typically wider than they are tall</p>
</div>
</div>
<div id="geometric-objects" class="section level1">
<h1>3.6 Geometric Objects</h1>
<p>These are the objects that are used to plot the data</p>
<pre class="r"><code># left
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/geoms-1.png" width="672" /></p>
<pre class="r"><code># right
ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy))</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/geoms-2.png" width="672" /></p>
<p>Not every aes is available for every geom type</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy, linetype = drv))</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/aes-geom-combos-1.png" width="672" /></p>
<p>It helps to use aes when splitting by groups since grouping alone doesn’t provide any legend</p>
<pre class="r"><code>ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy))</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/group-var-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy, group = drv))</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/group-var-2.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) +
  geom_smooth(
    mapping = aes(x = displ, y = hwy, color = drv),
    show.legend = FALSE
  )</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/group-var-3.png" width="672" /></p>
<p>To display multiple geoms in a plot</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_smooth(mapping = aes(x = displ, y = hwy))</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/multi-geoms-1.png" width="672" /></p>
<pre class="r"><code># and more compactly
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/multi-geoms-2.png" width="672" /></p>
<p>To use different aesthetics in different layers</p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = class)) + 
  geom_smooth()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/layer-aes-1.png" width="672" /></p>
<p>Also able to specifiy a different data within geoms</p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = class)) + 
  geom_smooth(data = filter(mpg, class == &quot;subcompact&quot;), se = FALSE)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/geom-data-1.png" width="672" /></p>
<div id="exercises-3" class="section level2">
<h2>3.6.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li>What geom would you use to draw a line chart? A boxplot? A histogram? An area chart?</li>
</ol>
<pre class="r"><code># line
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_line()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/geoms-different-1.png" width="672" /></p>
<pre class="r"><code># boxplot
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) + 
  geom_boxplot()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/geoms-different-2.png" width="672" /></p>
<pre class="r"><code># histogram
ggplot(data = mpg, mapping = aes(x = hwy)) + 
  geom_histogram()</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/geoms-different-3.png" width="672" /></p>
<pre class="r"><code># area chart
ggplot(data = mpg) + 
  geom_ribbon(aes(displ, ymin = 0, ymax = hwy, fill = drv, color = drv))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/geoms-different-4.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Run this code in your head and predict what the output will look like. Then, run the code in R and check your predictions.</li>
</ol>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) + 
  geom_point() + 
  geom_smooth(se = FALSE)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/scatterplot-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>What does show.legend = FALSE do? What happens if you remove it? Why do you think I used it earlier in the chapter?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) + 
  geom_point(show.legend = FALSE) + 
  geom_smooth(se = FALSE, show.legend = FALSE)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/legend-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>What does the se argument to geom_smooth() do?</li>
</ol>
<p>Shows / hides the confidence interval</p>
<ol start="5" style="list-style-type: decimal">
<li>Will these two graphs look different? Why/why not?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/same-graph-1.png" width="672" /></p>
<pre class="r"><code>ggplot() + 
  geom_point(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_smooth(data = mpg, mapping = aes(x = displ, y = hwy))</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/same-graph-2.png" width="672" /></p>
<p>They are both graphing the same data</p>
<ol start="6" style="list-style-type: decimal">
<li>Recreate the R code necessary to generate the following graphs.</li>
</ol>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth(se = FALSE)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/recreate-graphs-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth(aes(group = drv), se = FALSE)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/recreate-graphs-2.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) + 
  geom_point() +
  geom_smooth(se = FALSE)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/recreate-graphs-3.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(aes(color = drv)) +
  geom_smooth(se = FALSE)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/recreate-graphs-4.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(aes(color = drv)) +
  geom_smooth(aes(linetype = drv), se = FALSE)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/recreate-graphs-5.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(aes(fill = drv), shape = 21, stroke = 2, color = &quot;white&quot;) </code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/recreate-graphs-6.png" width="672" /></p>
</div>
</div>
<div id="statistical-transformations" class="section level1">
<h1>3.7 Statistical Transformations</h1>
<p>Several graphs plot the raw output of values in the dataset, however some graphs calculate new values for the plot, and the algorithm to produce these calculations is called the stat</p>
<pre class="r"><code>ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/bar-char-1.png" width="672" /></p>
<p>Different stats can be specified in the geom</p>
<pre class="r"><code>demo &lt;- tribble(
  ~cut,         ~freq,
  &quot;Fair&quot;,       1610,
  &quot;Good&quot;,       4906,
  &quot;Very Good&quot;,  12082,
  &quot;Premium&quot;,    13791,
  &quot;Ideal&quot;,      21551
)

ggplot(data = demo) +
  geom_bar(mapping = aes(x = cut, y = freq), stat = &quot;identity&quot;)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/identity-stat-1.png" width="672" /></p>
<p>Additionally you can override default mapping, ex display a bar chart as proportions</p>
<pre class="r"><code>ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, y = ..prop.., group = 1))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/bar-prop-1.png" width="672" /></p>
<p>Can also focus on the summary for the statistical transformation with <code>stat_summary()</code></p>
<pre class="r"><code>ggplot(data = diamonds) + 
  stat_summary(
    mapping = aes(x = cut, y = depth),
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median
  )</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/stat-summary-1.png" width="672" /></p>
<div id="exercises-4" class="section level2">
<h2>3.7.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li>What is the default geom associated with stat_summary()? How could you rewrite the previous plot to use that geom function instead of the stat function?</li>
</ol>
<p>pointrange</p>
<pre class="r"><code>ggplot(data = diamonds) + 
  geom_pointrange(
    mapping = aes(x = cut, y = depth),
    stat = &quot;summary&quot;,
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median
  )</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/pointrange-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>What does geom_col() do? How is it different to geom_bar()?</li>
</ol>
<p><code>geom_col()</code> uses the stat identity by default so if the values that are to be used for column heights are already in the data then it should be used</p>
<ol start="3" style="list-style-type: decimal">
<li>Most geoms and stats come in pairs that are almost always used in concert. Read through the documentation and make a list of all the pairs. What do they have in common?</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="center">geom</th>
<th align="center">stat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">area</td>
<td align="center">identity</td>
</tr>
<tr class="even">
<td align="center">ribbon</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">bar</td>
<td align="center">count</td>
</tr>
<tr class="even">
<td align="center">col</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">bin2d</td>
<td align="center">bind2d</td>
</tr>
<tr class="even">
<td align="center">blank</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">boxplot</td>
<td align="center">boxplot</td>
</tr>
<tr class="even">
<td align="center">contour</td>
<td align="center">contour</td>
</tr>
<tr class="odd">
<td align="center">count</td>
<td align="center">sum</td>
</tr>
<tr class="even">
<td align="center">crossbar</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">errorbar</td>
<td align="center">identity</td>
</tr>
<tr class="even">
<td align="center">errorbarh</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">linerange</td>
<td align="center">identity</td>
</tr>
<tr class="even">
<td align="center">pointrange</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">curve</td>
<td align="center">identity</td>
</tr>
<tr class="even">
<td align="center">segment</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">density</td>
<td align="center">density</td>
</tr>
<tr class="even">
<td align="center">density_2d</td>
<td align="center">density2d</td>
</tr>
<tr class="odd">
<td align="center">freqpoly</td>
<td align="center">bin</td>
</tr>
<tr class="even">
<td align="center">histogram</td>
<td align="center">bin</td>
</tr>
<tr class="odd">
<td align="center">hex</td>
<td align="center">binhex</td>
</tr>
<tr class="even">
<td align="center">jitter</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">label</td>
<td align="center">identity</td>
</tr>
<tr class="even">
<td align="center">path</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">line</td>
<td align="center">identity</td>
</tr>
<tr class="even">
<td align="center">map</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">point</td>
<td align="center">identity</td>
</tr>
<tr class="even">
<td align="center">polygon</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">quantile</td>
<td align="center">quantile</td>
</tr>
<tr class="even">
<td align="center">raster</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">rect</td>
<td align="center">identity</td>
</tr>
<tr class="even">
<td align="center">rug</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">smooth</td>
<td align="center">smooth</td>
</tr>
<tr class="even">
<td align="center">spoke</td>
<td align="center">spoke</td>
</tr>
<tr class="odd">
<td align="center">step</td>
<td align="center">identity</td>
</tr>
<tr class="even">
<td align="center">text</td>
<td align="center">identity</td>
</tr>
<tr class="odd">
<td align="center">tile</td>
<td align="center">identity</td>
</tr>
<tr class="even">
<td align="center">violin</td>
<td align="center">ydensity</td>
</tr>
</tbody>
</table>
<p>The majority of geoms use the identity stat so they require the data to contain the mapping values, while the remaining geoms are paired with the the stat that creates the specific shape of the plot from the data</p>
<ol start="4" style="list-style-type: decimal">
<li>What variables does stat_smooth() compute? What parameters control its behaviour?</li>
</ol>
<p>it computes the formula y ~ x, and is controlled by <code>method</code> which determines the type of line to fit, and <code>se</code> which shows / hides the confidence interval</p>
<ol start="5" style="list-style-type: decimal">
<li>In our proportion bar chart, we need to set group = 1. Why? In other words what is the problem with these two graphs?</li>
</ol>
<pre class="r"><code>ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, y = ..prop..))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/missing-group-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = color, y = ..prop..))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/missing-group-2.png" width="672" /></p>
<p>Each cut category proportion is calculated separately rather than as a proportion of the overall number of diamonds. Adding <code>group = 1</code> ensures that the proportions are calculated from the total count of diamonds. In the second plot the <code>fill = color</code> is getting the color proportion for the overall data set, while it should be pulling from each color category</p>
<pre class="r"><code>ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, y = ..prop.., group = 1))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/group-1-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, y = ..count../sum(..count..), fill = color)) + 
        ylab(&quot;prop&quot;)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/group-1-2.png" width="672" /></p>
</div>
</div>
<div id="position-adjustments" class="section level1">
<h1>3.8 Position Adjustments</h1>
<p>There are several position options for a bar chart, by default they are stacked</p>
<pre class="r"><code>ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity))</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/stacked-1.png" width="672" /></p>
<p>Another option is <code>identity</code> which is not as useful for bars since they wil overlap</p>
<pre class="r"><code>ggplot(data = diamonds, mapping = aes(x = cut, fill = clarity)) + 
  geom_bar(alpha = 1/5, position = &quot;identity&quot;)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/bar-identity-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = diamonds, mapping = aes(x = cut, colour = clarity)) + 
  geom_bar(fill = NA, position = &quot;identity&quot;)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/bar-identity-2.png" width="672" /></p>
<p><code>fill</code> is similar to stacking but makes all bars the same height</p>
<pre class="r"><code>ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity), position = &quot;fill&quot;)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/bar-fill-1.png" width="672" /></p>
<p><code>dodge</code> places the bars next to eachother so they are easy to compare</p>
<pre class="r"><code>ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity), position = &quot;dodge&quot;)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/bar-dodge-1.png" width="672" /></p>
<p><code>jitter</code> is not useful for bars but helpul to avoid overplotting with scatterplots</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), position = &quot;jitter&quot;)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/jitter-1.png" width="672" /></p>
<div id="exercises-5" class="section level2">
<h2>3.8.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li>What is the problem with this plot? How could you improve it?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) + 
  geom_point()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/overplot-1.png" width="672" /></p>
<p>The plot likely suffers from overplotting and could be improved by using <code>jitter</code></p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) + 
  geom_jitter()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/fix-with-jitter-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>What parameters to geom_jitter() control the amount of jittering?</li>
</ol>
<p><code>width</code> and <code>height</code> control the amount of jittering</p>
<ol start="3" style="list-style-type: decimal">
<li>Compare and contrast geom_jitter() with geom_count()</li>
</ol>
<p><code>jitter</code> adds random noise to separate values they may be plotted on top of eachother<br />
<code>count</code> tallies the amount of points in an area and then adjusts the size of the point to represent that amount</p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) + 
  geom_count()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/fix-with-count-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>What’s the default position adjustment for geom_boxplot()? Create a visualisation of the mpg dataset that demonstrates it.</li>
</ol>
<p>default position is <code>&quot;dodge&quot;</code></p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = drv, y = hwy)) + 
  geom_boxplot()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/default-boxplot-position-1.png" width="672" /></p>
</div>
</div>
<div id="coordinate-systems" class="section level1">
<h1>3.9 Coordinate Systems</h1>
<p>Lots of other options beyond regular x, y Cartesian that can occasionally be useful</p>
<p><code>coord_flip()</code> swaps x and y axis</p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = class, y = hwy)) + 
  geom_boxplot()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/coord-flip-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = class, y = hwy)) + 
  geom_boxplot() +
  coord_flip()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/coord-flip-2.png" width="672" /></p>
<p><code>coord_quickmap()</code> sets the aspect ratio correctly for maps</p>
<pre class="r"><code>nz &lt;- map_data(&quot;nz&quot;)

ggplot(nz, aes(long, lat, group = group)) +
  geom_polygon(fill = &quot;white&quot;, colour = &quot;black&quot;)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/coord-quickmap-1.png" width="672" /></p>
<pre class="r"><code>ggplot(nz, aes(long, lat, group = group)) +
  geom_polygon(fill = &quot;white&quot;, colour = &quot;black&quot;) +
  coord_quickmap()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/coord-quickmap-2.png" width="672" /></p>
<p><code>coord_polar()</code> uses polar coordinates</p>
<pre class="r"><code>bar &lt;- ggplot(data = diamonds) + 
  geom_bar(
    mapping = aes(x = cut, fill = cut), 
    show.legend = FALSE,
    width = 1
  ) + 
  theme(aspect.ratio = 1) +
  labs(x = NULL, y = NULL)

bar + coord_flip()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/coord-polar-1.png" width="672" /></p>
<pre class="r"><code>bar + coord_polar()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/coord-polar-2.png" width="672" /></p>
<div id="exercises-6" class="section level2">
<h2>3.9.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li>Turn a stacked bar chart into a pie chart using coord_polar()</li>
</ol>
<pre class="r"><code>bar &lt;- ggplot(data = diamonds) + 
  geom_bar(
    mapping = aes(x = 1, fill = color),
    width = 1) + 
  theme(aspect.ratio = 1) +
  labs(x = NULL, y = NULL)

bar</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/stackbar-pie-1.png" width="672" /></p>
<pre class="r"><code>bar + coord_polar(theta = &quot;y&quot;)</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/stackbar-pie-2.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>What does labs() do? Read the documentation.</li>
</ol>
<p>Good labels are critical for making your plots accessible to a wider audience. Ensure the axis and legend labels display the full variable name. Use the plot title and subtitle to explain the main findings. It’s common to use the caption to provide information about the data source.</p>
<ol start="3" style="list-style-type: decimal">
<li>What’s the difference between coord_quickmap() and coord_map()?</li>
</ol>
<p><code>coord_map</code> projects a portion of the earth, which is approximately spherical, onto a flat 2D plane using any projection defined by the mapproj package. Map projections do not, in general, preserve straight lines, so this requires considerable computation. <code>coord_quickmap</code> is a quick approximation that does preserve straight lines. It works best for smaller areas closer to the equator.</p>
<ol start="4" style="list-style-type: decimal">
<li>What does the plot below tell you about the relationship between city and highway mpg? Why is coord_fixed() important? What does geom_abline() do?</li>
</ol>
<pre class="r"><code>ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) +
  geom_point() + 
  geom_abline() +
  coord_fixed()</code></pre>
<p><img src="/post/2017-10-21-data-visualization_files/figure-html/cty-hwy-plot-1.png" width="672" /></p>
<p>cty and hwy have a positive linear relationship<br />
<code>coord_fixed()</code> sets the aspect ratio, so that the x and y axes have the same scale<br />
<code>geom_abline</code> adds a line with intercept = 0 and slope = 1</p>
</div>
</div>
<div id="the-layered-grammar-of-graphics" class="section level1">
<h1>3.10 The Layered Grammar of Graphics</h1>
<p>Now have a template for any ggplot</p>
<pre><code>ggplot(data = &lt;DATA&gt;) + 
  &lt;GEOM_FUNCTION&gt;(
     mapping = aes(&lt;MAPPINGS&gt;),
     stat = &lt;STAT&gt;, 
     position = &lt;POSITION&gt;
  ) +
  &lt;COORDINATE_FUNCTION&gt; +
  &lt;FACET_FUNCTION&gt;</code></pre>
</div>
